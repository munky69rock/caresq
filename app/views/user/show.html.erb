<%= content_for :title, 'マイページ' %>
<%= content_for :css do %>
  <%= stylesheet_link_tag :profile, media: 'all', 'data-turbolinks-track': 'reload' %>
<% end %>

<div class="text-center main-image">
  <img class="mx-auto img-thumbnail" src="https://api.adorable.io/avatars/285/<%= @user.email %>.png" alt="<%= @user.name %>">
</div>

<div class="container">
  <ul class="nav justify-content-end">
    <li class="nav-item">
      <%= link_to '編集', edit_user_index_path, class: 'nav-link' %>
    </li>
  </ul>

  <div class="card">
    <div class="card-block">
      <h4 class="card-title"><%= @user.name %></h4>
      <%= simple_format @user.description, class: 'card-text' %>
      <% if @user.address %>
        <p class="card-text"><%= @user.address.postal_code %> <%= @user.address.prefecture %><%= @user.address.city %></p>
      <% end %>
      <!--<p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>-->
    </div>
  </div>

  <h4 class="mt-3 mb-3">質問一覧</h4>
  <div class="list-group">
    <% @user.posts.each do |post| %>
      <a href="<%= post_path(post) %>" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
          <h5 class="mb-1"><%= post.title %></h5>
          <small class="text-muted"><%= distance_of_time_in_words_to_now post.updated_at %></small>
        </div>
        <p class="mb-1"><%= truncate post.body %></p>
      </a>
    <% end %>
  </div>

  <h4 class="mt-3 mb-3">回答一覧</h4>
  <div class="list-group">
    <% @user.comments.each do |comment| %>
      <% if comment.post.nil? %>
        <div class="list-group-item flex-column align-items-start">
          <div class="d-flex w-100 justify-content-between">
            <p class="mb-1 text-muted">(この質問は削除されました)</p>
            <small class="text-muted"><%= distance_of_time_in_words_to_now comment.updated_at %></small>
          </div>
          <p class="mb-1"><%= truncate comment.body %></p>
        </div>
      <% else %>
        <a href="<%= post_path(comment.post) %>" class="list-group-item list-group-item-action flex-column align-items-start">
          <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1"><%= comment.post.title %></h5>
            <small class="text-muted"><%= distance_of_time_in_words_to_now comment.updated_at %></small>
          </div>
          <p class="mb-1"><%= truncate comment.body %></p>
        </a>
      <% end %>
    <% end %>
  </div>
</div>
