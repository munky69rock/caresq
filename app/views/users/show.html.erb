<%= content_for :title, "#{@user.name}のプロフィール" %>
<%= content_for :css do %>
  <%= stylesheet_link_tag :profile, media: 'all', 'data-turbolinks-track': 'reload'  %>
<% end %>

<div class="profile-top text-center profile-top">
  <div class="profile-top__bg-top"></div>
  <img class="profile-top__image mx-auto img-thumbnail rounded-circle" src="https://api.adorable.io/avatars/285/<%= @user.email %>.png" alt="<%= @user.name %>">
  <div class="profile-top__bg-bottom-wrapper container">
    <div class="row">
      <div class="offset-0 offset-sm-0 offset-md-1 offset-lg-2 offset-xl-2"></div>
      <div class="profile-top__bg-bottom col-12 col-sm-12 col-md-10 col-lg-8 col-xl-8">
      </div>
      <div class="offset-0 offset-sm-0 offset-md-1 offset-lg-2 offset-xl-2"></div>
    </div>
  </div>
</div>

<div class="profile-main container">
  <div class="row">
    <div class="offset-0 offset-sm-0 offset-md-1 offset-lg-2 offset-xl-2"></div>
    <div class="profile-main__container col-12 col-sm-12 col-md-10 col-lg-8 col-xl-8">

      <h3 class="text-center pt-2"><%= @user.name %></h3>
      <% if @user.address.present? %>
      <p><%= @user.address.prefecture %><%= @user.address.city %></p>
      <% end %>

      <div class="row mt-2">
        <div class="col-6" style="border-bottom: 1px solid #ddd; border-right: 1px solid #ddd;">
          <h5 class="text-center">質問数</h5>
          <div class="text-center my-4">
            <span style="font-size: 5rem;"><%= @user.posts.count %></span>
          </div>
        </div>
        <div class="col-6" style="border-bottom: 1px solid #ddd;">
          <h5 class="text-center">回答数</h5>
          <div class="text-center my-4">
            <span style="font-size: 5rem;"><%= @user.comments.count %></span>
          </div>
        </div>
      </div>

      <% if @user.description.present? %>
      <div class="p-4 mt-2">
        <%= simple_format @user.description %>
      </div>
      <% end %>
    </div>
    <div class="offset-0 offset-sm-0 offset-md-1 offset-lg-2 offset-xl-2"></div>
  </div>
</div>

<% if @user.posts.present? %>
<div class="post-detail container">
  <div class="row">
    <div class="offset-0 offset-sm-0 offset-md-1 offset-lg-2 offset-xl-2"></div>
    <div class="post-detail__content-wrapper col-12 col-sm-12 col-md-10 col-lg-8 col-xl-8 p-0">
      <h4 class="mt-3 mb-3"><%= @user.name %>さんの質問</h4>
      <% @user.posts.each do |post| %>
        <div class="post-detail__content">
          <div class="row">
            <div class="col-12">
              <%= simple_format truncate(post.body) %>
            </div>
          </div>

          <div class="row">
            <div class="col-12 text-right">
              <% post.tags.each do |tag| %>
                <span class="badge badge-tag"><%= tag.value %></span>
              <% end %>
            </div>
          </div>

          <div class="row">
            <div class="col-10">
              <small class="text-muted"><%= distance_of_time_in_words_to_now post.updated_at %></small>
            </div>
            <div class="col-2">
            <span class="align-middle">
              <i class="fa fa-comment-o"></i>&nbsp;<%= post.comment_count %>
            </span>
            </div>
          </div>


        </div>
        <a href="<%= post_path(post) %>" class="d-block mb-3 text-right" style="border-top: 1px solid #ddd; background-color: #fff; padding: 1rem; box-shadow: 0 4px 4px #ccc;">
          <span>もっと見る</span>
          <span class="fa fa-chevron-right"></span>
        </a>
      <% end %>
    </div>
    <div class="offset-0 offset-sm-0 offset-md-1 offset-lg-2 offset-xl-2"></div>
  </div>
</div>
<% end %>

<% if @user.comments.present? %>
<div class="post-detail container">
  <div class="row">
    <div class="offset-0 offset-sm-0 offset-md-1 offset-lg-2 offset-xl-2"></div>
    <div class="post-detail__content-wrapper col-12 col-sm-12 col-md-10 col-lg-8 col-xl-8 p-0">
      <h4 class="mt-3 mb-3"><%= @user.name %>さんが回答した質問</h4>
      <% @user.comments.each do |comment| %>
        <div class="post-detail__content">
          <div class="row mb-2" style="height: 30px; line-height: 30px;">
            <div class="col-1">
              <img class="mx-auto align-top rounded-circle" src="https://api.adorable.io/avatars/28/<%= comment.post.user.email %>.png" alt="<%= comment.post.user.name %>" style="height: 30px;"/>
            </div>
            <div class="col-9">
              <%= link_to comment.post.user.name, user_path(comment.post.user), class: 'font-weight-bold' %>さん
            </div>
            <div class="col-2">
              <small><%= distance_of_time_in_words_to_now comment.post.updated_at %></small>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <%= simple_format truncate(comment.post.body) %>
            </div>
          </div>
        </div>
        <a href="<%= post_path(comment.post) %>" class="d-block mb-3 text-right" style="border-top: 1px solid #ddd; background-color: #fff; padding: 1rem; box-shadow: 0 4px 4px #ccc;">
          <span>もっと見る</span>
          <span class="fa fa-chevron-right"></span>
        </a>
      <% end %>
    </div>
    <div class="offset-0 offset-sm-0 offset-md-1 offset-lg-2 offset-xl-2"></div>
  </div>
</div>
<% end %>
